/*! jQuery.touchdragh (https://github.com/Takazudo/jQuery.touchdragh)
 * lastupdate: 2014-11-18
 * version: 1.6.6
 * author: 'Takazudo' Takeshi Takatsudo <takazudo@gmail.com>
 * License: MIT */
(function(){var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},n=function(t,e){return function(){return t.apply(e,arguments)}};(function(t,r,i){var o,s,h;return s=t(r),o=t(i),h=t.TouchdraghNs={},h.normalizeXY=function(t){var e,n,r;return n={},e=t.originalEvent,null!=e.changedTouches?(r=e.changedTouches[0],n.x=r.pageX,n.y=r.pageY):(n.x=t.pageX||e.pageX,n.y=t.pageY||e.pageY),n},h.calcHighestHeight=function(e){var n;return n=0,e.each(function(e,r){var i;return i=t(r).outerHeight(),i>n?n=i:void 0}),n},h.support={},h.ua={},h.support.addEventListener="addEventListener"in i,h.support.touch="ontouchend"in i,h.support.mspointer=r.navigator.msPointerEnabled||!1,h.support.transition=function(){return t.support.transition&&t.support.transform&&null!=t.fn.transition?!0:!1}(),h.transitionEnabled=h.support.transition,h.enableTransition=function(){h.support.transition&&(h.support.transition=!0)},h.disableTransition=function(){h.support.transition&&(h.support.transition=!1)},h.ua.win8orhigh=function(){var t,e,n;return e=navigator.userAgent,(t=e.match(/Windows NT ([\d\.]+)/))?(n=1*t[1],6.2>n?!1:!0):!1}(),h.getEventNameSet=function(t){var e;switch(e={},t){case"touchstart":e.move="touchmove",e.end="touchend";break;case"mousedown":e.move="mousemove",e.end="mouseup";break;case"MSPointerDown":e.move="MSPointerMove",e.end="MSPointerUp";break;case"pointerdown":e.move="pointermove",e.end="pointerup"}return e},h.getLeftPx=function(t){var e,n;return n=h.transitionEnabled?"x":"left",e=t.css(n),e="auto"===e?0:1*e.replace(/px/,"")},h.startWatchGestures=function(){var t,e;return e=!1,t=function(){return e=!0,o.bind("gesturestart",function(){return h.whileGesture=!0}),o.bind("gestureend",function(){return h.whileGesture=!1})},function(){return this.initDone?void 0:t()}}(),h.OneDrag=function(t){function n(){this._scrollDirectionDecided=!1}return e(n,t),n.prototype.applyTouchStart=function(t){var e;return e=h.normalizeXY(t),this.startPageX=e.x,this.startPageY=e.y,this},n.prototype.applyTouchMove=function(t){var e,n,r,i,o=this;return e=h.normalizeXY(t),i=function(){var t;return t=e.x-o.startPageX,o.trigger("dragmove",{x:t})},this._scrollDirectionDecided?i():(n=Math.abs(e.x-this.startPageX),r=Math.abs(e.y-this.startPageY),(n>5||r>5)&&(this._scrollDirectionDecided=!0,n>5?this.trigger("xscrolldetected"):r>5&&this.trigger("yscrolldetected"))),this},n.prototype.destroy=function(){return this.off(),this},n}(r.EveEve),h.TouchdraghEl=function(r){function i(e,r){this.$el=e,this._handleTouchEnd=n(this._handleTouchEnd,this),this._handleTouchMove=n(this._handleTouchMove,this),this._handleTouchStart=n(this._handleTouchStart,this),this._handleClickToIgnore=n(this._handleClickToIgnore,this),this.el=this.$el[0],this.options=t.extend({},this.defaults,r),this.disabled=!1,this._prepareDraggers(),this._handeleAnnoyingDragPreventers(),h.startWatchGestures(),this._handlePointerEvents(),this._prepareEls(),this._eventify(),this.options.triggerrefreshimmediately&&this.refresh()}return e(i,r),i.prototype.defaults={inner:"> *",backanim_duration:250,backanim_easing:"swing",beforefirstrefresh:null,triggerrefreshimmediately:!0,tweakinnerpositionstyle:!1,alwayspreventtouchmove:!1,dragger:null,useonlydragger:!1,forever:!1,mstouchaction:"pan-y",handeleAnnoyingDragPreventers:!0},i.prototype._handeleAnnoyingDragPreventers=function(){return this.options.handeleAnnoyingDragPreventers?this.$draggers.delegate("a, img","drag",function(t){return t.preventDefault()}):void 0},i.prototype._prepareDraggers=function(){return this.$draggers=this.options.useonlydragger?t():this.$el,this.options.dragger&&(this.$draggers=this.$draggers.add(t(this.options.dragger))),this},i.prototype.refresh=function(){return this._calcMinMaxLeft(),this._handleTooNarrow(),this._handleInnerOver(),this._firstRefreshDone||(this.options.beforefirstrefresh&&this.options.beforefirstrefresh(this),this.trigger("firstrefresh",this),this._firstRefreshDone=!0),this.trigger("refresh",this),this},i.prototype._handlePointerEvents=function(){return h.support.mspointer?(this.el.style.msTouchAction=this.options.mstouchaction,this):this},i.prototype._prepareEls=function(){return this.$inner=this.$el.find(this.options.inner),this.options.tweakinnerpositionstyle&&this.$inner.css({position:"relative"}),h.transitionEnabled&&this.$inner.css({x:0}),this},i.prototype._calcMinMaxLeft=function(){return this.options.forever?(this._maxLeft=null,this._minLeft=null):(this._maxLeft=0,this._minLeft=-(this.$inner.outerWidth()-this.$el.innerWidth())),this},i.prototype._eventify=function(){var e;return e="pointerdown MSPointerDown touchstart mousedown",this.$draggers.bind(e,this._handleTouchStart),h.support.addEventListener&&this.el.addEventListener("click",t.noop,!0),this},i.prototype._handleClickToIgnore=function(t){return t.stopPropagation(),t.preventDefault(),this},i.prototype._handleTouchStart=function(t){var e,n=this;return this.disabled?this:this._whileDrag?this:h.whileGesture?this:("mousedown"===t.type&&t.preventDefault(),this._currentEventNameSet=h.getEventNameSet(t.type),this._whileDrag=!0,this._slidecanceled=!1,this._shouldSlideInner=!1,e=this._currentDrag=new h.OneDrag,e.on("yscrolldetected",function(){return n._whileDrag=!1,n._slidecanceled=!0,n.trigger("slidecancel")}),e.on("xscrolldetected",function(){return n._shouldSlideInner=!0,n.trigger("dragstart"),n.$el.delegate("a","click",n._handleClickToIgnore)}),e.on("dragmove",function(t){return n.trigger("drag"),n._moveInner(t.x)}),this._innerStartLeft=h.getLeftPx(this.$inner),e.applyTouchStart(t),o.bind(this._currentEventNameSet.move,this._handleTouchMove),o.bind(this._currentEventNameSet.end,this._handleTouchEnd),this)},i.prototype._handleTouchMove=function(t){return this._whileDrag?h.whileGesture?this:(this._currentDrag.applyTouchMove(t),(this.options.alwayspreventtouchmove||this._shouldSlideInner)&&(t.preventDefault(),t.stopPropagation()),this):this},i.prototype._handleTouchEnd=function(){var t=this;return this._whileDrag=!1,o.unbind(this._currentEventNameSet.move,this._handleTouchMove),o.unbind(this._currentEventNameSet.end,this._handleTouchEnd),this._currentDrag.destroy(),this._currentEventNameSet=null,this._slidecanceled||this.trigger("dragend"),setTimeout(function(){return t.$el.undelegate("a","click",t._handleClickToIgnore)},10),this._handleInnerOver(!0),this},i.prototype._moveInner=function(t){var e,n,r;return n=this._innerStartLeft+t,null!==this._maxLeft&&(n>this._maxLeft?n=this._maxLeft+(n-this._maxLeft)/3:this._minLeft>n&&(n=this._minLeft+(n-this._minLeft)/3)),r=h.transitionEnabled?{x:n}:{left:n},this.$inner.css(r),e={left:n},this.trigger("move",e),this},i.prototype._handleInnerOver=function(t){var e,n,r,i,o,s=this;if(null==t&&(t=!1),this.isInnerTooNarrow())return this;if(o=function(){return t?s.trigger("moveend"):void 0},i=null,n=this.currentSlideLeft(),null===this._maxLeft)o();else{if(r=n>this._maxLeft,e=this._minLeft>n,!r&&!e)return o(),this;r&&(i=this._maxLeft),e&&(i=this._minLeft),this.slide(i,!0,function(){return o()})}return this},i.prototype._handleTooNarrow=function(){return this.isInnerTooNarrow()?(this.disable(),this.$inner.css("left",0)):this.enable(),this},i.prototype.isInnerTooNarrow=function(){var t,e;return t=this.$el.width(),e=this.$inner.width(),t>=e},i.prototype.disable=function(){return this.disabled=!0,this},i.prototype.enable=function(){return this.disabled=!1,this},i.prototype.slide=function(e,n,r){var i,o,s,u=this;return null==n&&(n=!1),null!==this._maxLeft&&(e>this._maxLeft&&(e=this._maxLeft),this._minLeft>e&&(e=this._minLeft)),i=this.options.backanim_duration,o=this.options.backanim_easing,s=h.transitionEnabled?{x:e}:{left:e},t.Deferred(function(t){var e;return u.trigger("beforeslide"),e=function(){return u.trigger("afterslide"),"function"==typeof r&&r(),t.resolve()},n?h.transitionEnabled?(o="easeOutExpo",u.$inner.stop().transition(s,i,o,function(){return e()})):u.$inner.stop().animate(s,i,o,function(){return e()}):(u.$inner.stop().css(s),e())}).promise()},i.prototype.currentSlideLeft=function(){return h.getLeftPx(this.$inner)},i.prototype.isCurrentLeftMax=function(){return this.currentSlideLeft()===this._minLeft},i.prototype.isCurrentLeftMin=function(){return this.currentSlideLeft()===this._maxLeft},i.prototype.updateInnerWidth=function(t){return this.$inner.width(t),this},i}(r.EveEve),h.TouchdraghFitty=function(n){function r(e,n){this.$el=e,this.options=t.extend({},this.defaults,n),this.currentIndex=this.options.startindex,this._prepareTouchdragh(),this.options.triggerrefreshimmediately&&this.refresh()}return e(r,n),r.prototype.defaults={item:null,beforefirstfresh:null,startindex:0,triggerrefreshimmediately:!0},r.prototype._prepareTouchdragh=function(){var e,n=this;return e=t.extend({},this.options),e.triggerrefreshimmediately=!1,e.beforefirstrefresh=function(t){return t.once("firstrefresh",function(){var t;return"function"==typeof(t=n.options).beforefirstrefresh&&t.beforefirstrefresh(n),n.trigger("firstrefresh",n),n._firstRefreshDone=!0}),t.on("refresh",function(){return n.trigger("refresh")}),t.on("slidecancel",function(){return n.trigger("slidecancel")}),t.on("dragstart",function(){return n.trigger("dragstart")}),t.on("drag",function(){return n.trigger("drag")}),t.on("dragend",function(){return n.trigger("dragend")}),t.on("moveend",function(){var e,r,i,o;return o=-t.currentSlideLeft(),r=n.$el.innerWidth(),i=null,e=o/r,n.currentIndex>e?i=n.currentIndex-1:e>n.currentIndex&&(i=n.currentIndex+1),null!==i?(n.updateIndex(i),n.adjustToFit(r,!0)):void 0})},this._touchdragh=new h.TouchdraghEl(this.$el,e),this},r.prototype.updateIndex=function(t){var e,n;return t>=0&&this.$items.length>t?(n=this.currentIndex,this.currentIndex=t,n!==t&&(e={index:this.currentIndex},this.trigger("indexchange",e)),!0):!1},r.prototype.refresh=function(){var t,e;return this.$items=this.$el.find(this.options.item),e=this._itemWidth=this.$el.innerWidth(),t=e*this.$items.length,this._touchdragh.updateInnerWidth(t),this.$items.width(e),this._touchdragh.refresh(),this.adjustToFit(e),this},r.prototype.adjustToFit=function(e,n,r){var i=this;return null==n&&(n=!1),null==e&&(e=this.$items.width()),t.Deferred(function(t){var o,s,h;return o=i.currentIndex,s=-e*o,h=i._touchdragh.currentSlideLeft(),s===h?(t.resolve(),i):(i._sliding||i.trigger("slidestart"),i._sliding=!0,i._touchdragh.slide(s,n,function(){var e;return i._sliding=!1,e={index:i.currentIndex},i.trigger("slideend",e),"function"==typeof r&&r(),t.resolve()}))}).promise()},r.prototype.to=function(e,n){var r,i=this;return null==n&&(n=!1),r=this.updateIndex(e),t.Deferred(function(t){return r?i.adjustToFit(null,n,function(){return t.resolve()}):(i.trigger("invalidindexrequested"),t.resolve())}).promise()},r.prototype.next=function(t){return null==t&&(t=!1),this.to(this.currentIndex+1,t)},r.prototype.prev=function(t){return null==t&&(t=!1),this.to(this.currentIndex-1,t)},r}(r.EveEve),h.ForeverInner=function(n){function r(e,n,r){var i,o;this.$inner=e,this.$inner2=n,o=this.options=t.extend({},this.defaults,r),i=this.$inner2.find(o.selector_item).length,this.origItemsCount=i,this.baseIndex=i*o.forever_duplicate_count,this._duplicateInside()}return e(r,n),r.prototype.defaults={baseleft:null,stepwidth:null,widthbetween:null,forever_duplicate_count:1},r.prototype.handleIndexchange=function(t){var e,n,r,i;if(r=null,this.baseIndex>t)for(n=-1;;){if(e=this.baseIndex+n*this.origItemsCount,i=this.baseIndex+(n+1)*this.origItemsCount,t>=e&&i>t){r=n;break}n-=1}if(t>=this.baseIndex)for(n=0;;){if(e=this.baseIndex+n*this.origItemsCount,i=this.baseIndex+(n+1)*this.origItemsCount,t>=e&&i>t){r=n;break}n+=1}return this._changeLeftFromOffset(r),this._handleInner2Width(),this},r.prototype._changeLeftFromOffset=function(t){var e,n,r;return e=this.options,r=this.origItemsCount*(e.stepwidth+e.widthbetween),n=e.baseleft+t*r,this.currentInner2Left=n,this.$inner2.css("left",n),this},r.prototype._handleInner2Width=function(){return this.$inner2.width(this.$inner.width()-this.options.baseleft+3)},r.prototype._duplicateInside=function(){var t,e,n;for(t=this.$inner2.html(),e=1,n=2*this.options.forever_duplicate_count;n>=1?n>=e:e>=n;n>=1?e++:e--)this.$inner2.append(t);return this},r}(r.EveEve),h.TouchdraghSteppy=function(r){function i(e,r){var i;this.$el=e,this._handleMoveend=n(this._handleMoveend,this),i=this.options=t.extend({},this.defaults,r),this.steppy_disabled=!1,this.currentIndex=i.startindex,this._setupForever(),this._prepareTouchdragh(),i.triggerrefreshimmediately&&this.refresh(),this._eventify(),i.forever&&(this.to(this._foreverInner.baseIndex+i.startindex),this.on("indexchange",function(t){return this._foreverInner.handleIndexchange(t.index)}))}return e(i,r),i.prototype.defaults={item:null,inner:null,inner2:null,inner2left:0,beforefirstfresh:null,startindex:0,maxindex:"auto",triggerrefreshimmediately:!0,stepwidth:300,widthbetween:0,forever:!1,forever_duplicate_count:1,normalize_height:!1,normalize_height_on_resize:!1},i.prototype._eventify=function(){var t=this;return this.options.normalize_height_on_resize?s.bind("resize",function(){return t.normalizeHeight()}):void 0},i.prototype._setupForever=function(){var t,e;return t=this.options,t.forever?(e={widthbetween:t.widthbetween,stepwidth:t.stepwidth,baseleft:t.inner2left,forever_duplicate_count:t.forever_duplicate_count,selector_item:t.item},this.$inner=this.$el.find(t.inner),this.$inner2=this.$el.find(t.inner2),this._foreverInner=new h.ForeverInner(this.$inner,this.$inner2,e),this):this},i.prototype._prepareTouchdragh=function(){var e,n=this;return e=t.extend({},this.options),e.triggerrefreshimmediately=!1,e.beforefirstrefresh=function(t){return t.once("firstrefresh",function(){var t;return"function"==typeof(t=n.options).beforefirstrefresh&&t.beforefirstrefresh(n),n.trigger("firstrefresh",n),n._firstRefreshDone=!0}),t.on("refresh",function(){return n.trigger("refresh")}),t.on("slidecancel",function(){return n.trigger("slidecancel")}),t.on("dragstart",function(){return n.trigger("dragstart")}),t.on("drag",function(){return n.trigger("drag")}),t.on("dragend",function(){return n.trigger("dragend")}),t.on("moveend",n._handleMoveend)},this.touchdragh=new h.TouchdraghEl(this.$el,e),this},i.prototype._handleMoveend=function(){var t;if(!this.steppy_disabled)return t=this._calcIndexFromCurrentSlideLeft(),this.updateIndex(t),this.adjustToFit(!0)},i.prototype._calcIndexFromCurrentSlideLeft=function(){var t,e,n,r,i,o,s,h,u=this;return o=this.touchdragh.currentSlideLeft(),i=0,s=null,h=!1,e=!1,t=!1,r=function(){var n,r,a,d;for(d=[];;){if(a=u._calcLeftFromIndex(i),r=u._calcLeftFromIndex(i-1),n=a+(r-a-u.options.widthbetween)/2,o>=a&&r>=o&&((o===a||o===r)&&(h=!0),o>=n?(s=i-1,e=!0):(s=i,t=!0)),null!==s)break;d.push(i-=1)}return d},n=function(){var n,r,a,d;for(d=[];;){if(!u.options.forever&&i>u._maxindex)break;if(a=u._calcLeftFromIndex(i+1),r=u._calcLeftFromIndex(i),n=a+(r-a+u.options.widthbetween)/2,o>=a&&r>=o&&((o===a||o===r)&&(h=!0),o>=n?(s=i,e=!0):(s=i+1,t=!0)),null!==s)break;d.push(i+=1)}return d},this.options.forever?(0===o&&(h=!0),0>o&&n(),o>0&&r()):n(),s!==this.currentIndex||h||(e?s+=1:t&&(s-=1)),0>s&&(s=0),s>this._maxindex&&(s=this._maxindex),s},i.prototype.updateIndex=function(t){var e,n;return this.options.forever!==!1||t>=0&&this._maxindex>=t?(n=this.currentIndex,this.currentIndex=t,n!==t&&(e={index:this.currentIndex},this.options.forever&&(e.normalizedIndex=this._calcNormalizedIndex()),this.trigger("indexchange",e)),!0):!1},i.prototype.refresh=function(){var t,e,n;return this.$items=this.$el.find(this.options.item),e=this.$items.length,this._maxindex="auto"===this.options.maxindex?e-1:this.options.maxindex,n=this.options.stepwidth,t=n*e,e>0&&(t+=this.options.widthbetween*(e-1)),this.touchdragh.updateInnerWidth(t),this.$items.width(n),this.touchdragh.refresh(),this.normalizeHeight(),this.adjustToFit(),this},i.prototype.normalizeHeight=function(){var e,n;return this.options.normalize_height===!1?this:(e=t().add(this.$el).add(this.$items).add(this.$inner).add(this.$inner2),e.css("min-height","0px"),n=h.calcHighestHeight(this.$items),e.css("min-height",""+n+"px"),this.trigger("heightnormalized",n),this)},i.prototype._calcLeftFromIndex=function(t){var e,n,r,i;if(i=this.options.stepwidth,e=this.options.widthbetween,n=0,r=0,0===t)return 0;if(t>0)for(;t>n;)n+=1,r-=i,0!==n&&(r-=e);if(0>t)for(;n>t;)n-=1,r+=i,0!==n&&(r+=e);return r},i.prototype._calcNormalizedIndex=function(){var t,e,n,r,i;return n=this.options,e=this._foreverInner.origItemsCount,r=e*n.forever_duplicate_count,t=this.currentIndex-r,i=t%e,0>t&&(i=e-Math.abs(i),i===e&&(i=0)),i},i.prototype.adjustToFit=function(e,n){var r,i,o=this;return null==e&&(e=!1),i=this.options.stepwidth,r=this.options.widthbetween,t.Deferred(function(t){var r,i;return r=o._calcLeftFromIndex(o.currentIndex),i=o.touchdragh.currentSlideLeft(),r===i?(t.resolve(),o):(o._sliding||o.trigger("slidestart"),o._sliding=!0,o.touchdragh.slide(r,e,function(){var e;return o._sliding=!1,e={index:o.currentIndex},o.trigger("slideend",e),"function"==typeof n&&n(),t.resolve()}))}).promise()},i.prototype.to=function(e,n){var r,i=this;return null==n&&(n=!1),r=this.updateIndex(e),t.Deferred(function(t){return r?i.adjustToFit(n,function(){return t.resolve()}):(i.trigger("invalidindexrequested"),t.resolve())}).promise()},i.prototype.next=function(t){return null==t&&(t=!1),this.to(this.currentIndex+1,t)},i.prototype.prev=function(t){return null==t&&(t=!1),this.to(this.currentIndex-1,t)},i.prototype.updateOption=function(e){return this.options=t.extend(this.options,e),this.refresh(),this},i.prototype.steppify=function(){return this.steppy_disabled=!1,this},i.prototype.unsteppify=function(){return this.steppy_disabled=!0,this},i}(r.EveEve),t.fn.touchdragh=function(e){return this.each(function(n,r){var i,o;i=t(r),o=new h.TouchdraghEl(i,e),i.data("touchdragh",o)})},t.fn.touchdraghfitty=function(e){return this.each(function(n,r){var i,o;i=t(r),o=new h.TouchdraghFitty(i,e),i.data("touchdraghfitty",o)})},t.fn.touchdraghsteppy=function(e){return this.each(function(n,r){var i,o;i=t(r),o=new h.TouchdraghSteppy(i,e),i.data("touchdraghsteppy",o)})},t.Touchdragh=h.TouchdraghEl,t.TouchdraghFitty=h.TouchdraghFitty})(jQuery,window,document)}).call(this);